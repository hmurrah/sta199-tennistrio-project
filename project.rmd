---
title: "Project Draft - Tennis Trio"
subtitle: "Due Friday, October 9, 11:59 PM"
author: "Tennis Trio: Hamilton Murrah, Kellyn McDonald, Naima Turbes"
output: pdf_document
---
```{r packages-data, warning=FALSE, message=FALSE}
library(tidyverse)
library(tidytext)
wine_data <- read_csv("data/winemag-data_first150k.csv") 
```

### Introduction

People have cultivated and appreciated wines for millennia. In fact, the oldest known winery was found in a cave outside of a village in Armenia and dates back to 4,100 BC. Since then, wine production and consumption spread throughout the globe and become a important part of many cultures. Today, wine is largely used as a celebratory drink during activities like weddings or holidays. Fine wines are often more expensive and associated with higher societal status or class (https://winefolly.com/deep-dive/where-did-wine-come-from/#:~:text=Ancient%20wine%20production%20evidence%20dates,grape%20domestication%20in%20eastern%20Turkey)
.

Most current wine production happens in Europe. In 2019, Italy produced 21.6 million hectoliters of wine and was the world's largest wine producer. The next two largest wine producers that year were Spain and France, producing 21.3 million hectoliters and 14.2 million hectoliters respectively. Nevertheless, a 2019 survey from Forbes found that the the best ranked wine was from Napa Valley in the United States (https://www.forbes.com/sites/eustaciahuen/2019/03/25/wine-3/#6b2719750ed0). We are curious to see if this has changed.

We investigated wine ratings from wine enthusiasts around the globe using wine ranking data scraped from WineEnthusiast.com.

Our main motivation for investigating wine data is pure interest and desire to understand how to select the best wine. We are specifically interested in how the perceived quality of these wines varies based on where they were produced. Additionally, we want to understand what words wine enthusiasts use to describe highly rated wines versus lower rated wines. Finally, in an attempt to find the best wine to buy, we want to investigate and characterize what wines have the best value for their rating. We hypothesize that the best wines are also the most expensive wines, come from France and Italy, and are described using positive descriptors.

### Data Description

User zackthoutt on Kaggle collected this data by scraping data from WineEnthusiast.com.

A description of the columns of our data set are as follows

- `X1`: Number corresponding to the observation. Listed in ascending order from 0
- `country`: The country that the wine is from
- `description`: A few sentences from a sommelier describing the wine's taste, smell, look, feel, etc.
- `designation`: The vineyard within the winery where the grapes that made the wine are from
- `points`: The number of points WineEnthusiast rated the wine on a scale of 1-100 (though they say they only post reviews for wines that score $\geq$ 80)
- `price`: The cost for a bottle of the wine
- `province`: The province or state that the wine is from
- `region_1`: The wine growing area in a province or state (ie Napa)
- `region_2`: Sometimes there are more specific regions specified within a wine growing area (ie Rutherford inside the Napa Valley), but this value can sometimes be blank
- `variety`: The type of grapes used to make the wine (ie Pinot Noir)
- `winery`: The winery that made the wine


### Glimpse of data

```{r, echo = FALSE}
glimpse(wine_data)
```
### Methodology
 
We performed the following tests and statistical methods to evaluate our research question.
 
1. We calculated on average which countries have the highest rated wines by finding the mean scores of each country and summarizing the data into a table. We did the same calculation for top varieties of wine.

2. We created a linear model to predict the number of points that a wine would receive depending on whether or not it was made in a top country or not and whether it was a top variety or not.
 
3. We evaluated whether or not it is appropriate to use CLT based tests. [STILL NEED TO DO THIS]
 
4. We used a CLT based t test to determine whether there is a statistically significant difference between the highest rated country's average score and the average wine score for all countries.

5. We created density plots for the point distribution for the top 5 varieties and top 5 countries. 

6. We created similar density plots for the price distribution for the top 5 varieties and top 5 countries. [STILL NEED TO DO THIS]
 
** have countries be different colors
 
7. We will calculate on average which variety of wine has the highest rating by calculating the mean scores of each variety and summarizing the data into a table. We will also visualize this data using a histogram.
 
8. We will use text analysis on the description variable to pick out key word descriptors in order to determine if there is there a relationship between the descriptor and the score. We will visualize this relationship.


Countries with Highest Average Wine Point Score
``` {r highest_average_score_by_country, echo = FALSE, warning = F, message = F}
country_counts <- wine_data %>%
    group_by(country) %>%
    count(country) %>%
    filter(n >= 100)

relevant_countries <- wine_data %>%
    filter(!is.na(points) & !is.na(price)) %>%
    filter(country %in% country_counts$country)

best_country <- relevant_countries %>%
    filter(!is.na(country)) %>%
    select(country, points, price) %>%
    group_by(country) %>%
    summarize(avg = mean(points)) %>%
    arrange(desc(avg)) %>%
    top_n(5)
best_country

score_test <- wine_data %>%
    filter(!is.na(country)) %>%
    group_by(country) %>%
    summarize(avg = mean(points))

weighted_avg_test <- wine_data %>%
    group_by(country) %>%
    mutate(weighted_count = (points/price))


```
Contrary to our hypothesis, Italy and France were not the top two countries. Both Austria and Germany had on average higher point ratings for their wines than these two countries. The top 5 countries with the highest average wine score are Austria, Germany, France, US, and Italy in that order.

We recognize that this list of top 5 countries may not be an accurate representation of where the best wines come from, but rather a representation of what location on average has the wines with the highest point ratings. This calculation rewards countries with one highly rated wine and disadvantages countries that have wines represented in the data set with both very high and very low point values.

Varieties with Highest Average Wine Point Score
```{r highest_and_lowest_average_points_by_variety, warning = F, message = F, echo= FALSE}
variety_means <- wine_data %>% 
    group_by(variety) %>% 
    summarize(mean = mean(points)) %>% 
    arrange(desc(mean)) %>% 
    top_n(5)
variety_means

variety_counts <- wine_data %>%
    group_by(variety) %>%
    count(variety) %>%
    filter(n >= 50)

variety_means_more_than_50 <- wine_data %>%
    group_by(variety) %>% 
    summarize(mean = mean(points)) %>% 
    arrange(desc(mean)) %>% 
    filter(variety %in% variety_counts$variety) %>%
    top_n(5)
variety_means_more_than_50

variety_means_more_than_50_bottom_5 <- wine_data %>%
    group_by(variety) %>% 
    summarize(mean = mean(points)) %>% 
    arrange((mean)) %>% 
    filter(variety %in% variety_counts$variety) %>%
    top_n(-5)
variety_means_more_than_50_bottom_5
```

We calculated the top 5 best rated varieties of wine similarly. Our first calculation returned Cabernet-Shiraz, Cabernet Sauvignon-Shiraz, Blauburgunder, Friulano, and Carignan as the top rated wine varieties. However, after observing the data, we noticed that these wine varieties had a relatively small number of wines represented in the entire data set. To try to better represent the varieties of wines with consistently top rated products, we filtered to only include wine varieties with at least 50 wines ratings represented in the data set. The top varieties presented in this calculation were Gewürztraminer, Grüner Veltliner, Pinot Gris, Pinot Noir, and Riesling. 


```{r, echo = FALSE}

# make density plots of the top 5 varieties, add the density plots of the top 5 countries

# make a linear model of top 5 countries and top 5 varieties


lmthingy <- wine_data %>%
  mutate (top_countries = ifelse(country == "Austria" | country == "France"| country == "US" | country == "Italy" | country == "Germany", 1, 0)) %>%
  mutate (top_varieties = ifelse(variety == "Gewürztraminer" | variety == "Grüner Veltliner"| variety == "Pinot Gris" | variety == "Pinot Noir" | variety == "Riesling", 1, 0))

lmthingy
 
modell <- lm(points ~ top_countries + top_varieties, data = lmthingy)
tidy(modell)


```

predicted points = 88.13 + 0.66(topcountry) + 1.145(topvariety)

This is a linear model that shows the predicted number of points for a particular wine given whether or not the wine is from a top country and whether or not the wine is from a top variety.



``` {r average_wine_score_clt, message = FALSE, warning = FALSE, echo = FALSE}
t.test(wine_data$points,
       mu = 90.93939,
       alternative = "two.sided")
```
Here, we see that the overall mean of all wine scores is 88.88125 and has a 95% confidence interval or 88.82544 to 88.93706. This shows us that our observed average score of 90.79 for the top rated wine country (Austria) has statistical significance in its difference from the mean.

```{r, echo = FALSE}
country_counts <- wine_data %>%
    group_by(country) %>%
    count(country) %>%
    filter(n >= 100)

country_counts


top_countries <- wine_data %>% 
  filter(country == "Austria" |
           country == "Germany" |
           country == "France" |
           country == "US" |
           country == "Italy")

ggplot(data = top_countries, mapping = aes(points)) + 
  geom_density() + 
  facet_wrap(~country)
```

```{r, echo= FALSE}

top_var <- wine_data %>% 
  filter(variety == "Gewürztraminer" |
           variety == "Grüner Veltliner" |
           variety == "Pinot Gris" |
           variety == "Pinot Noir" |
           variety == "Riesling")

ggplot(data = top_var, mapping = aes(points)) + 
  geom_density() + 
  facet_wrap(~variety)

```



What are the most commonly used words to describe a merlot for example. Is there a difference in the types of words used to describe the types of wines based on region, type, price.

Are the presence of certain words associated with higher price. Fit a linear regression model. Definitely mention which words we also take out as stop words.


``` {r sentiment_analysis_top_5_varieties, message = F, warning = F, echo = FALSE}
Gewürztraminer <- wine_data %>%
    filter(variety == "Gewürztraminer")
descriptions <- tibble(txt = Gewürztraminer$description)
unnested_Gewürztraminer <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "pinot" & word != "gris" & word != "generous" &
               word != "hints" & word != "gewürztraminer" & word != "noir" &
               word != "riesling" & word != "grüner" & word != "veltliner" &
               word != "nose" & word != "fresh" & word != "fruit") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Gewürztraminer %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Gewürztraminer Wines",
         x = "Descriptor Words",
         y = "Frequency")

Grüner_Veltliner <- wine_data %>%
    filter(variety == "Grüner Veltliner")
descriptions <- tibble(txt = Grüner_Veltliner$description)
unnested_Grüner_Veltliner <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "pinot" & word != "gris" & word != "generous" &
               word != "hints" & word != "gewürztraminer" & word != "noir" &
               word != "riesling" & word != "grüner" & word != "veltliner" &
               word != "nose" & word != "fresh" & word != "fruit") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Grüner_Veltliner %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Grüner Veltliner Wines",
         x = "Descriptor Words",
         y = "frequency")

Pinot_Gris <- wine_data %>%
    filter(variety == "Pinot Gris")
descriptions <- tibble(txt = Pinot_Gris$description)
unnested_Pinot_Gris <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "pinot" & word != "gris" & word != "generous" &
               word != "hints" & word != "gewürztraminer" & word != "noir" &
               word != "riesling" & word != "grüner" & word != "veltliner" &
               word != "nose" & word != "fresh" & word != "fruit") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Pinot_Gris %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Pinot Gris Wines",
         x = "Descriptor Words",
         y = "Frequency")

Pinot_Noir <- wine_data %>%
    filter(variety == "Pinot Noir")
descriptions <- tibble(txt = Pinot_Noir$description)
unnested_Pinot_Noir <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "pinot" & word != "gris" & word != "generous" &
               word != "hints" & word != "gewürztraminer" & word != "noir" &
               word != "riesling" & word != "grüner" & word != "veltliner" &
               word != "nose" & word != "fresh" & word != "fruit") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Pinot_Noir %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Pinot Noir Wines",
         x = "Descriptor Words",
         y = "Frequency")

Riesling <- wine_data %>%
    filter(variety == "Riesling")
descriptions <- tibble(txt = Riesling$description)
unnested_Riesling <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "pinot" & word != "gris" & word != "generous" &
               word != "hints" & word != "gewürztraminer" & word != "noir" &
               word != "riesling" & word != "grüner" & word != "veltliner" &
               word != "nose" & word != "fresh" & word != "fruit") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Riesling %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Riesling Wines",
         x = "Descriptor Words",
         y = "Frequency")
```

**Unsure if we want to show these graphs or not since we do graphs of them combined below**

``` {r sentiment_analysis_bottom_5_varieties, message = F, warning = F, echo = F}
Portuguese_White <- wine_data %>%
    filter(variety == "Portuguese White")
descriptions <- tibble(txt = Portuguese_White$description)
unnested_Portuguese_White <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "generous" & word != "hints" & word != "nose" &
               word != "fresh" & word != "fruit" & word != "full" & 
               word != "character" & word != "ready" & word != "100" & 
               word != "merlot" & word != "texture" & word != "end" & 
               word != "medium" & word != "bodied" & word != "malbec" & 
               word != "portuguese" & word != "chardonnay" & word != "blanc" &
               word != "viognier" & word != "note" & word != "show" &
               word != "vineyard" & word != "style" & word != "shows" & 
               word != "make" & word != "pinot" & word != "sauvignon" &
               word != "body" & word != "bottling" & word != "alongside") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Portuguese_White %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Portuguese White Wines",
         x = "Descriptor Words",
         y = "Frequency")

Merlot <- wine_data %>%
    filter(variety == "Merlot")
descriptions <- tibble(txt = Merlot$description)
unnested_Merlot <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "generous" & word != "hints" & word != "nose" &
               word != "fresh" & word != "fruit" & word != "full" & 
               word != "character" & word != "ready" & word != "100" & 
               word != "merlot" & word != "texture" & word != "end" & 
               word != "medium" & word != "bodied" & word != "malbec" & 
               word != "portuguese" & word != "chardonnay" & word != "blanc" &
               word != "viognier" & word != "note" & word != "show" &
               word != "vineyard" & word != "style" & word != "shows" & 
               word != "make" & word != "pinot" & word != "sauvignon" &
               word != "body" & word != "bottling" & word != "alongside") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Merlot %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Merlot Wines",
         x = "Descriptor Words",
         y = "Frequency")

Malbec <- wine_data %>%
    filter(variety == "Malbec")
descriptions <- tibble(txt = Malbec$description)
unnested_Malbec <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "generous" & word != "hints" & word != "nose" &
               word != "fresh" & word != "fruit" & word != "full" & 
               word != "character" & word != "ready" & word != "100" & 
               word != "merlot" & word != "texture" & word != "end" & 
               word != "medium" & word != "bodied" & word != "malbec" & 
               word != "portuguese" & word != "chardonnay" & word != "blanc" &
               word != "viognier" & word != "note" & word != "show" &
               word != "vineyard" & word != "style" & word != "shows" & 
               word != "make" & word != "pinot" & word != "sauvignon" &
               word != "body" & word != "bottling" & word != "alongside") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Malbec %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Malbec Wines",
         x = "Descriptor Words",
         y = "Frequency")

White_Blend <- wine_data %>%
    filter(variety == "White Blend")
descriptions <- tibble(txt = White_Blend$description)
unnested_White_Blend <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "generous" & word != "hints" & word != "nose" &
               word != "fresh" & word != "fruit" & word != "full" & 
               word != "character" & word != "ready" & word != "100" & 
               word != "merlot" & word != "texture" & word != "end" & 
               word != "medium" & word != "bodied" & word != "malbec" & 
               word != "portuguese" & word != "chardonnay" & word != "blanc" &
               word != "viognier" & word != "note" & word != "show" &
               word != "vineyard" & word != "style" & word != "shows" & 
               word != "make" & word != "pinot" & word != "sauvignon" &
               word != "body" & word != "bottling" & word != "alongside") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_White_Blend %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In White Blend Wines",
         x = "Descriptor Words",
         y = "Frequency")

Viognier <- wine_data %>%
    filter(variety == "Viognier")
descriptions <- tibble(txt = Viognier$description)
unnested_Viognier <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long" &
               word != "generous" & word != "hints" & word != "nose" &
               word != "fresh" & word != "fruit" & word != "full" & 
               word != "character" & word != "ready" & word != "100" & 
               word != "merlot" & word != "texture" & word != "end" & 
               word != "medium" & word != "bodied" & word != "malbec" & 
               word != "portuguese" & word != "chardonnay" & word != "blanc" &
               word != "viognier" & word != "note" & word != "show" &
               word != "vineyard" & word != "style" & word != "shows" & 
               word != "make" & word != "pinot" & word != "sauvignon" &
               word != "body" & word != "bottling" & word != "alongside") %>%
  anti_join(get_stopwords(source = "smart"))
unnested_Viognier %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Viognier Wines",
         x = "Descriptor Words",
         y = "Frequency")


```

**Unsure if we want to show these graphs or not since we do graphs of them combined below**

``` {r descriptor_word_differences, message = F, warning = F, echo = F}
top_5_descriptors <- tibble(word = union_all(unnested_Gewürztraminer$word, 
               unnested_Grüner_Veltliner$word,
               unnested_Pinot_Gris$word,
               unnested_Pinot_Noir$word,
               unnested_Riesling$word))
top_5_descriptor_counts <- top_5_descriptors %>%
  count(word) %>%
  mutate(prob = round(n/sum(n),4)) %>%
  arrange(desc(prob)) %>%
  top_n(10)


bottom_5_descriptors <- tibble(word = union_all(unnested_Portuguese_White$word,
               unnested_White_Blend$word,
               unnested_Malbec$word,
               unnested_Merlot$word,
               unnested_Viognier$word))
bottom_5_descriptor_counts <- bottom_5_descriptors %>%
  count(word) %>%
  mutate(prob = round(n/sum(n),4)) %>%
  arrange(desc(prob)) %>%
  top_n(10)
```



``` {r descriptor_plots, message = F, warning = F, echo = F}
ggplot(data = top_5_descriptor_counts, aes(fct_reorder(word, prob), prob)) +
    geom_col(color = "darkblue", fill = "skyblue") +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Top 5 Wines",
         x = "Descriptor Words",
         y = "Frequency")

ggplot(data = bottom_5_descriptor_counts, aes(fct_reorder(word, prob), prob)) +
    geom_col(color = "darkblue", fill = "skyblue") +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Bottom 5 Wines",
         x = "Descriptor Words",
         y = "Frequency")
```

**Make comments here about words in top 5 and bottom 5 and connections. Red over white for example**


``` {r sentiment_analysis_price_over_100, warning = F, message = F, echo = FALSE}
over_100 <- wine_data %>%
    filter(price >= 100)
descriptions <- tibble(txt = over_100$description)
unnested_over_100 <- descriptions %>%
  unnest_tokens(word, txt) %>%
    filter(word != "wine" & word != "flavors" & word != "palate" &
               word != "drink" & word != "aromas" & word != "offers" &
               word != "finish" & word != "notes" & word != "long")
unnested_Gewürztraminer %>%
  anti_join(get_stopwords(source = "smart")) %>%
  count(word) %>%
  arrange(desc(n)) %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency Of Descriptor Words In Expensive Wines",
         y = "Frequency",
         x = "Descriptor Words")
```

``` {r weighted_wine_scores_to_price, message = FALSE, warning = FALSE, echo = FALSE}
weighted_avg <- wine_data %>%
    group_by(country)%>%
    summarize(country, winery, variety, price, country, points, weighted = points/price) %>%
        arrange(desc(weighted))

weighted_avg

weighted_avg <- relevant_countries %>% 
    mutate(weighted = log((price/points), base = exp(1))) %>% 
    mutate(top_3 = if_else(country == "Austria" |
                               country == "Germany" |
                               country == "France",
                           country, "Other"))

weighted_avg

ggplot(data = weighted_avg, mapping = aes(x = price, y = weighted)) + 
    geom_point() + 
    geom_smooth(method = "lm", se = F) + facet_wrap(~top_3)

```
*** we are trying to make graph that has countries on the x axis and a weighted count of wines on the y axis. the weighted count will be equal to the count of wines in the top 100 times the weighted points/ price score. 


```{r}

austria <- relevant_countries %>% 
    mutate(weighted = log((price/points), base = exp(1))) %>% 
    filter (country == "Austria")


ggplot(data = austria, mapping = aes(x = price, y = weighted)) + 
    geom_point() + 
    geom_smooth(method = "lm", se = F) 

```


``` {r, echo = FALSE}
m_points = glm(price ~ points, data = weighted_avg)
tidy(m_points)
```


### Results


### Discussion

points to bring up: austria is the best. more expensive wines are better up to a point (need to determine this point, use a linear model)



### References
